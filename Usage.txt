The pipeline for non-reference retrotransposon insertion polymorphisms (RIPs) calling of human in this program includes 2 steps.

=== STEP 1 ===

The first step collects informative reads and generates other necessary files for step 2.
We use 01discordant_v2.pl to accomplish this function.

Usage: perl 01discordant_v2.pl -bamlist <string> -refTEs <string> [-outDir <string>] [-nosort] [-temp] [-split] [-name]

       -bamlist  A file include all bamfile names prepared to beed processed (one BAM per line)
       -refTEs   TE reference file (with its BLAST index in the same dir)
       [-outDir  Appoint the output directory]
       [-nosort  Input bam file is nosorted.Default is sorted]
       [-temp    Do not remove intermediate output files. Default is to cleanup]
       [-nosplit If the input bamfiles haven't been splited by RG library,please choose it.If you choose -nosplit,please ensure there is only one BAM in bamlist.]
       [-name    If you input mulit files, you can appoint the name of result file. Default is unknown.]

Note: 
1. 01discordant_v2.pl requires samtools(v0.1.18), BLAST to be in the default path. 
2. The BAM files in the bamlist should retain replicates or it may stop running accidentally.

Example:
perl 01discordant_v2.pl -bamlist BamList.txt -refTEs TE.fa -outDir /USER/TE/TEST -nosplit -name Human_TE

=== STEP 2 ===

The second step discovers the specific insertion site and outputs the final results into a plain text.
We use 02cluster.pl to accomplish this function.

Usage: perl 02cluster.pl -uniqueBam <string> -Bam <string> -fastaref <string> -info <string> -m8file <string> -outfile <string>

       -uniqueBam     Unique Bam file generated by step 1
       -Bam           Total bam file (a merged BAM file of the step 1's bamList )
       -fastaref      Reference fasta files
       -info          Info file generated by step 1
       -m8file        M8 repeat file generated by step 1
       -outfile       Outfile (a plain text)

Note:
1. 02cluster.pl requires samtools(v0.1.18), BLAST to be in the default path.
2. The resulting file may contain some queries without specific insertion site, you should remove them by hand at present. We will optimize the output soon.

Example:
perl 02cluster.pl -uniqueBam NA18537.lst.unique.srt.rmdup.bam  \
                  -Bam NA18537.sort.bam \
                  -fastaref human.fasta \
                  -info NA18537.lst.info \
                  -m8file NA18537.lst.repeat.m8 \
                  -outfile NA18537.TE.list
